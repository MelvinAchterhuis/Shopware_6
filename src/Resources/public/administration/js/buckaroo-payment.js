(this.webpackJsonp=this.webpackJsonp||[]).push([["buckaroo-payment"],{"2Glv":function(e,t){const{Application:o}=Shopware,r=Shopware.Classes.ApiService;class a extends r{constructor(e,t,o="buckaroo"){super(e,t,o)}refundPayment(e,t){const o=`_action/${this.getApiBasePath()}/refund`;return this.httpClient.post(o,{transaction:e,amount:t},{headers:this.getBasicHeaders()}).then(e=>r.handleResponse(e))}}o.addServiceProvider("BuckarooPaymentService",e=>{const t=o.getContainer("init");return new a(t.httpClient,e.loginService)})},"2p9Z":function(e,t,o){var r=o("Y4wM");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,o("SZ7m").default)("31b09f66",r,!0,{})},"Cz+n":function(e){e.exports=JSON.parse('{"buckaroo-payment":{"general":{"title":"Orders","description":"Orders"},"tabs":{"title":"Buckaroo Payment","overview":"Overview"},"refund":{"amountTitle":"Amount","buttonTitle":"Refund","successTitle":"Success","successMessage":"Buckaroo success refunded ","errorTitle":"Error"}}}')},MKSE:function(e){e.exports=JSON.parse('{"buckaroo-payment":{"general":{"title":"Bestellungen","description":"Bestellungen"},"tabs":{"title":"Buckaroo Payment","overview":"Ãœbersicht"},"refund":{"amountTitle":"Amount","buttonTitle":"Refund","successTitle":"Success","successMessage":"Buckaroo success refunded ","errorTitle":"Error"}}}')},Y4wM:function(e,t,o){},YZ49:function(e,t){e.exports='{% block sw_order_detail_content_tabs_general %}\n    {% parent %}\n\n    <sw-tabs-item v-if="setIsBuckarooPayment" :route="{ name: \'buckaroo.payment.detail\', params: { id: $route.params.id } }" :title="$tc(\'buckaroo-payment.tabs.title\')">\n        {{ $tc(\'buckaroo-payment.tabs.title\') }}\n    </sw-tabs-item>\n    \n{% endblock %}\n\n{% block sw_order_detail_actions %}\n    <template v-if="isEditable">\n        {% parent %}\n    </template>\n{% endblock %}'},pLZ4:function(e,t,o){"use strict";o.r(t);var r=o("YZ49"),a=o.n(r);const{Component:n,Context:s}=Shopware,i=Shopware.Data.Criteria;n.override("sw-order-detail",{template:a.a,data:()=>({isBuckarooPayment:!1}),computed:{isEditable(){return!this.isBuckarooPayment||"buckaroo.payment.detail"!==this.$route.name},showTabs:()=>!0},watch:{orderId:{deep:!0,handler(){if(!this.orderId)return void this.setIsBuckarooPayment(null);const e=this.repositoryFactory.create("order"),t=new i(1,1);t.addAssociation("transactions"),e.get(this.orderId,s.api,t).then(e=>{if(e.transactions.length<=0||!e.transactions[0].paymentMethodId)return void this.setIsBuckarooPayment(null);const t=e.transactions[0].paymentMethodId;null!=t&&this.setIsBuckarooPayment(t)})},immediate:!0}},methods:{setIsBuckarooPayment(e){if(!e)return;this.repositoryFactory.create("payment_method").get(e,s.api).then(e=>{this.isBuckarooPayment=e.formattedHandlerIdentifier.indexOf("buckaroo")>=0})}}});var c=o("wlgm"),u=o.n(c);o("2p9Z");const{Component:d,Mixin:l,Filter:m,Context:p}=Shopware,h=Shopware.Data.Criteria;d.register("buckaroo-payment-detail",{template:u.a,inject:["repositoryFactory","BuckarooPaymentService"],mixins:[l.getByName("notification")],data:()=>({buckaroo_refund_amount:"0",currency:"EUR",isLoading:!1}),computed:{dateFilter:()=>m.getByName("date")},created(){this.createdComponent()},methods:{createdComponent(){let e=this;const t=this.$route.params.id,o=this.repositoryFactory.create("order"),r=new h(1,1);this.orderId=t,r.addAssociation("transactions"),o.get(t,p.api,r).then(t=>{e.buckaroo_refund_amount=t.amountTotal})},refundOrder(e,t){let o=this;this.BuckarooPaymentService.refundPayment(e,t).then(()=>{this.createNotificationSuccess({title:this.$tc("buckaroo-payment.refund.successTitle"),message:this.$tc("buckaroo-payment.refund.successMessage")+this.buckaroo_refund_amount+" "+this.currency}),o.reloadEntityData()}).catch(e=>{this.createNotificationError({title:this.$tc("buckaroo-payment.refund.errorTitle"),message:e.response.data.message})})}}});var b=o("MKSE"),k=o("Cz+n");const{Module:y}=Shopware;y.register("buckaroo-payment",{type:"plugin",name:"BuckarooPayment",title:"buckaroo.general.title",description:"buckaroo.general.description",version:"1.0.0",targetVersion:"1.0.0",color:"#000000",snippets:{"de-DE":b,"en-GB":k},routeMiddleware(e,t){"sw.order.detail"===t.name&&t.children.push({component:"buckaroo-payment-detail",name:"buckaroo.payment.detail",isChildren:!0,path:"/sw/order/buckaroo/detail/:id"}),e(t)}});o("2Glv")},wlgm:function(e,t){e.exports='{% block buckaroo_payment_detail %}\n    <div class="buckaroo-payment-detail">\n         <sw-card :title="$tc(\'Refund\')">\n            <sw-number-field :label="$tc(\'buckaroo-payment.refund.amountTitle\')" v-model="buckaroo_refund_amount"></sw-number-field>\n            <sw-button @click="refundOrder(orderId, buckaroo_refund_amount)">\n                {{ $tc(\'buckaroo-payment.refund.buttonTitle\') }}\n            </sw-button>\n         </sw-card>\n        <sw-loader v-if="isLoading">\n        </sw-loader>\n    </div>\n{% endblock %}'}},[["pLZ4","runtime","vendors-node"]]]);