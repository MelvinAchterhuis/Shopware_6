(this.webpackJsonp=this.webpackJsonp||[]).push([["buckaroo-payment"],{"2Glv":function(e,t){const{Application:n}=Shopware,o=Shopware.Classes.ApiService;class a extends o{constructor(e,t,n="buckaroo"){super(e,t,n)}refundPayment(e,t){const n=`_action/${this.getApiBasePath()}/refund`;return this.httpClient.post(n,{transaction:e,amount:t},{headers:this.getBasicHeaders()}).then(e=>o.handleResponse(e))}}n.addServiceProvider("BuckarooPaymentService",e=>{const t=n.getContainer("init");return new a(t.httpClient,e.loginService)})},"2p9Z":function(e,t,n){var o=n("Y4wM");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);(0,n("SZ7m").default)("31b09f66",o,!0,{})},"4kjK":function(e,t,n){},"6lJh":function(e,t,n){},CE1z:function(e){e.exports=JSON.parse('{"buckaroo-payment":{"order":{"refundDescription":"Terugbetaling voor bestelling #orderNumber"},"general":{"title":"Buckaroo","description":"Buckaroo Payment"},"settingsForm":{"save":"Opslaan","titleSuccess":"Succes","titleError":"Fout"},"supportModal":{"menuButton":"Ondersteuning van de versie","title":"Ondersteuning van de versie","support":{"description":"Voordat u contact opneemt met Buckaroo technische ondersteuning, kunt u uw (Merchant) sleutel, geheime sleutel, certificaat en certificaat duimafdruk ophalen.","label1":"Buckaroo Payment Plaza:","label2":"Telefoon:","label3":"E-mail:","label4":"Website:","your_version":"Uw PHP versie:","version":"Verenigbaarheid van versie","information":"Informatie"}},"tabs":{"title":"Buckaroo Payment","overview":"Overzicht"},"refund":{"amountTitle":"Bedrag","buttonTitle":"Terugbetaling","successTitle":"Succes","successMessage":"Buckaroo succes terugbetaald ","errorTitle":"Fout"},"messageNotBlank":"Dit veld mag niet leeg zijn."}}')},"Cz+n":function(e){e.exports=JSON.parse('{"buckaroo-payment":{"order":{"refundDescription":"Refund for order #orderNumber"},"general":{"title":"Buckaroo","description":"Buckaroo Payment"},"settingsForm":{"save":"Save","titleSuccess":"Success","titleError":"Error"},"supportModal":{"menuButton":"Version & Support","title":"Version & Support","support":{"description":"Before contacting Buckaroo technical support, please retrieve your (Merchant) key, Secret key, certificate and certificate thumbprint.","label1":"Buckaroo Payment Plaza:","label2":"Phone:","label3":"E-mail:","label4":"Website:","your_version":"Your PHP version:","version":"Version compatibility","information":"Information"}},"tabs":{"title":"Buckaroo Payment","overview":"Overview"},"refund":{"amountTitle":"Amount","buttonTitle":"Refund","successTitle":"Success","successMessage":"Buckaroo success refunded ","errorTitle":"Error"},"messageNotBlank":"This field must not be empty."}}')},MKSE:function(e){e.exports=JSON.parse('{"buckaroo-payment":{"order":{"refundDescription":"Erstattung für Bestellung #orderNumber"},"general":{"title":"Buckaroo","description":"Buckaroo Payment"},"settingsForm":{"save":"Speichern","titleSuccess":"Erfolg","titleError":"Fehler"},"supportModal":{"menuButton":"Version & Support","title":"Version & Support","support":{"description":"Bevor Sie den technischen Support von Buckaroo kontaktieren, rufen Sie bitte Ihren (Merchant) Schlüssel, Geheimschlüssel, Zertifikat und Zertifikat-Daumenabdruck auf.","label1":"Buckaroo Payment Plaza:","label2":"Telefon:","label3":"E-mail:","label4":"Webseite:","your_version":"Ihre PHP Version:","version":"Kompatibilität der Version","information":"Information"}},"tabs":{"title":"Buckaroo Payment","overview":"Overview"},"refund":{"amountTitle":"Betrag","buttonTitle":"Erstattung","successTitle":"Erfolg","successMessage":"Buckaroo erfolg zurückerstattet","errorTitle":"Fehler"},"messageNotBlank":"Dieses Feld darf nicht leer sein."}}')},"Uf7/":function(e,t,n){var o=n("4kjK");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);(0,n("SZ7m").default)("ef5b552a",o,!0,{})},Vrcm:function(e,t){e.exports="{% block sw_plugin_list_grid_columns_actions_settings %}\n    <template v-if=\"item.composerName === 'buckaroo/shopware6'\">\n        <sw-context-menu-item :routerLink=\"{ name: 'buckaroo.payment.index' }\">\n            {{ $tc('sw-plugin.list.config') }}\n        </sw-context-menu-item>\n    </template>\n\n    <template v-else>\n        {% parent %}\n    </template>\n{% endblock %}\n"},Y4wM:function(e,t,n){},YZ49:function(e,t){e.exports='{% block sw_order_detail_content_tabs_general %}\n    {% parent %}\n\n    <sw-tabs-item v-if="setIsBuckarooPayment" :route="{ name: \'buckaroo.payment.detail\', params: { id: $route.params.id } }" :title="$tc(\'buckaroo-payment.tabs.title\')">\n        {{ $tc(\'buckaroo-payment.tabs.title\') }}\n    </sw-tabs-item>\n    \n{% endblock %}\n\n{% block sw_order_detail_actions %}\n    <template v-if="isEditable">\n        {% parent %}\n    </template>\n{% endblock %}'},czOy:function(e,t){const{Application:n}=Shopware,o=Shopware.Classes.ApiService;class a extends o{constructor(e,t,n="buckaroo"){super(e,t,n)}getSupportVersion(){const e=`_action/${this.getApiBasePath()}/support/version`;return this.httpClient.post(e,{},{headers:this.getBasicHeaders()}).then(e=>o.handleResponse(e))}}n.addServiceProvider("BuckarooPaymentSettingsService",e=>{const t=n.getContainer("init");return new a(t.httpClient,e.loginService)})},jtnP:function(e,t){e.exports='{% block buckaroo_payment %}\n<sw-page class="buckaroo-payment">\n    {% block buckaroo_payment_header %}\n    <template #smart-bar-header>\n        <h2>\n            {{ $tc(\'sw-settings.index.title\') }}\n            <sw-icon name="small-arrow-medium-right" small></sw-icon>\n            {{ $tc(\'buckaroo-payment.general.title\') }}\n        </h2>\n    </template>\n    {% endblock %}\n\n    {% block buckaroo_payment_actions %}\n    <template #smart-bar-actions>\n        {% block buckaroo_payment_settings_actions_feedback %}\n        <sw-button\n                @click="isSupportModalOpen = true"\n                :disabled="false"\n                variant="ghost"\n                :square="false"\n                :block="false"\n                :isLoading="false">\n            {{ $tc(\'buckaroo-payment.supportModal.menuButton\') }}\n        </sw-button>\n        {% endblock %}\n\n        {% block buckaroo_payment_settings_actions_save %}\n        <sw-button-process\n                class="sw-settings-login-registration__save-action"\n                :isLoading="isLoading"\n                :processSuccess="isSaveSuccessful"\n                :disabled="isLoading"\n                variant="primary"\n                @process-finish="saveFinish"\n                @click="onSave">\n            {{ $tc(\'buckaroo-payment.settingsForm.save\') }}\n        </sw-button-process>\n        {% endblock %}\n    </template>\n    {% endblock %}\n\n    {% block buckaroo_payment_settings_content %}\n    <template #content>\n        <sw-modal\n                v-if="isSupportModalOpen"\n                @modal-close="isSupportModalOpen = false"\n                :title="$tc(\'buckaroo-payment.supportModal.title\')"\n                class="buckaroo-feedback sw-modal--large">\n            <sw-container columns="1fr">\n                <div class="buckaroo-feedback__col">\n                    <p class="buckaroo-feedback__desc">\n                        <a href="https://buckaroo.nl/" target="_blank">\n                            <img src="/bundles/buckaroopayment/storefront/buckaroo/logo/buckaroo_config_logo_black.png" >\n                        </a>\n                    </p>\n                </div>\n            </sw-container>\n\n            <sw-container columns="1fr 1fr">\n                <div class="buckaroo-feedback__col">\n                    <p class="buckaroo-feedback__desc">\n                        <h3>{{ $tc(\'buckaroo-payment.supportModal.support.version\') }}</h3>\n                        \n                        <div class="row">\n                            <div class="column">{{ $tc(\'buckaroo-payment.supportModal.support.your_version\') }}</div>\n                            <div class="column">{{ phpversion }}\n                                <sw-icon v-if="isPhpVersionSupport" name="default-basic-checkmark-line" color="#37d046"></sw-icon>\n                                <sw-icon v-else name="default-basic-x-line" color="#de294c"></sw-icon>\n                            </div>\n                        </div>\n                    </p>\n                </div>\n\n                <div class="buckaroo-feedback__col">\n                    <p class="buckaroo-feedback__desc">\n                        <h3>{{ $tc(\'buckaroo-payment.supportModal.support.information\') }}</h3>\n                        <p>{{ $tc(\'buckaroo-payment.supportModal.support.description\') }} <br><br></p>\n  \n                        <div class="row">\n                            <div class="column">{{ $tc(\'buckaroo-payment.supportModal.support.label1\') }}</div>\n                            <div class="column"><a target="_blank" href="https://plaza.buckaroo.nl/">plaza.buckaroo.nl</a></div>\n                        </div>\n\n                        <div class="row">\n                            <div class="column">{{ $tc(\'buckaroo-payment.supportModal.support.label2\') }}</div>\n                            <div class="column">+31(0)30-711 50 50</div>\n                        </div>\n\n                        <div class="row">\n                            <div class="column">{{ $tc(\'buckaroo-payment.supportModal.support.label3\') }}</div>\n                            <div class="column"><a href="mailto:support@buckaroo.nl">support@buckaroo.nl</a></div>\n                        </div>\n\n                        <div class="row">\n                            <div class="column">{{ $tc(\'buckaroo-payment.supportModal.support.label4\') }}</div>\n                            <div class="column"><a href="https://buckaroo.nl/" target="_blank">buckaroo.nl</a></div>\n                        </div>\n                    </p>\n                </div>\n            </sw-container>\n        </sw-modal>\n\n        <sw-card-view>\n            <sw-system-config\n                    ref="systemConfig"\n                    salesChannelSwitchable\n                    inherit\n                    @config-changed="onConfigChange"\n                    domain="BuckarooPayment.config">\n                <template #card-element="{ element, config }">\n                    <sw-form-field-renderer\n                            v-bind="getBind(element, config)"\n                            v-model="config[element.name]"/>\n                </template>\n            </sw-system-config>\n        </sw-card-view>\n    </template>\n    {% endblock %}\n</sw-page>\n{% endblock %}\n'},pLZ4:function(e,t,n){"use strict";n.r(t);var o=n("jtnP"),a=n.n(o);n("Uf7/");const{Component:s,Mixin:i}=Shopware;s.register("buckaroo-settings",{template:a.a,mixins:[i.getByName("notification"),i.getByName("sw-inline-snippet")],inject:["BuckarooPaymentSettingsService"],data:()=>({isLoading:!1,isSaveSuccessful:!1,config:{},websiteKeyIdFilled:!1,secretKeyIdFilled:!1,showValidationErrors:!1,phpversion:!1,isSupportModalOpen:!1,isPhpVersionSupport:!1}),created(){var e=this;this.createdComponent(),this.BuckarooPaymentSettingsService.getSupportVersion().then(t=>{e.phpversion=t.phpversion,e.isPhpVersionSupport=t.isPhpVersionSupport})},computed:{credentialsMissing:function(){return!this.websiteKeyIdFilled||!this.secretKeyIdFilled}},metaInfo(){return{title:this.$createTitle()}},methods:{createdComponent(){},saveFinish(){this.isSaveSuccessful=!1},onConfigChange(e){this.config=e,this.checkCredentialsFilled(),this.showValidationErrors=!1},checkCredentialsFilled(){this.websiteKeyIdFilled=!!this.getConfigValue("websiteKey"),this.secretKeyIdFilled=!!this.getConfigValue("secretKey")},getConfigValue(e){const t=this.$refs.systemConfig.actualConfigData.null;return null===this.$refs.systemConfig.currentSalesChannelId?this.config[`BuckarooPayment.config.${e}`]:this.config[`BuckarooPayment.config.${e}`]||t[`BuckarooPayment.config.${e}`]},getPaymentConfigValue(e,t){let n=e.charAt(0).toUpperCase()+e.slice(1);return this.getConfigValue(t+n)||this.getConfigValue(e)},onSave(){this.credentialsMissing?this.showValidationErrors=!0:(this.isSaveSuccessful=!1,this.isLoading=!0,this.$refs.systemConfig.saveAll().then(()=>{this.isLoading=!1,this.isSaveSuccessful=!0}).catch(()=>{this.isLoading=!1}))},getBind(e,t){return t!==this.config&&this.onConfigChange(t),this.showValidationErrors&&("BuckarooPayment.config.websiteKey"!==e.name||this.websiteKeyIdFilled||(e.config.error={code:1,detail:this.$tc("buckaroo-payment.messageNotBlank")}),"BuckarooPayment.config.secretKey"!==e.name||this.websiteKeyIdFilled||(e.config.error={code:1,detail:this.$tc("buckaroo-payment.messageNotBlank")})),e}}});var r=n("YZ49"),c=n.n(r);const{Component:l,Context:u}=Shopware,d=Shopware.Data.Criteria;l.override("sw-order-detail",{template:c.a,data:()=>({isBuckarooPayment:!1}),computed:{isEditable(){return!this.isBuckarooPayment||"buckaroo.payment.detail"!==this.$route.name},showTabs:()=>!0},watch:{orderId:{deep:!0,handler(){if(!this.orderId)return void this.setIsBuckarooPayment(null);const e=this.repositoryFactory.create("order"),t=new d(1,1);t.addAssociation("transactions"),e.get(this.orderId,u.api,t).then(e=>{if(e.transactions.length<=0||!e.transactions[0].paymentMethodId)return void this.setIsBuckarooPayment(null);const t=e.transactions[0].paymentMethodId;null!=t&&this.setIsBuckarooPayment(t)})},immediate:!0}},methods:{setIsBuckarooPayment(e){if(!e)return;this.repositoryFactory.create("payment_method").get(e,u.api).then(e=>{this.isBuckarooPayment=e.formattedHandlerIdentifier.indexOf("buckaroo")>=0})}}});var p=n("Vrcm"),m=n.n(p);const{Component:b}=Shopware;b.override("sw-plugin-list",{template:m.a});var h=n("q+HN"),k=n.n(h);n("qDl2");const{Component:f}=Shopware;f.override("sw-settings-index",{template:k.a});var g=n("wlgm"),v=n.n(g);n("2p9Z");const{Component:y,Mixin:w,Filter:S,Context:_}=Shopware,B=Shopware.Data.Criteria;y.register("buckaroo-payment-detail",{template:v.a,inject:["repositoryFactory","BuckarooPaymentService"],mixins:[w.getByName("notification")],data:()=>({buckaroo_refund_amount:"0",currency:"EUR",isRefundPossible:!0,isLoading:!1}),computed:{dateFilter:()=>S.getByName("date")},created(){this.createdComponent()},methods:{createdComponent(){let e=this;const t=this.$route.params.id,n=this.repositoryFactory.create("order"),o=new B(1,1);this.orderId=t,o.addAssociation("transactions"),n.get(t,_.api,o).then(t=>{e.buckaroo_refund_amount=t.amountTotal})},refundOrder(e,t){let n=this;n.isRefundPossible=!1,this.BuckarooPaymentService.refundPayment(e,t).then(()=>{this.createNotificationSuccess({title:this.$tc("buckaroo-payment.refund.successTitle"),message:this.$tc("buckaroo-payment.refund.successMessage")+this.buckaroo_refund_amount.toFixed(2)+" "+this.currency}),n.isRefundPossible=!0,n.reloadEntityData()}).catch(e=>{this.createNotificationError({title:this.$tc("buckaroo-payment.refund.errorTitle"),message:e.response.data.message}),n.isRefundPossible=!0})}}});var P=n("CE1z"),C=n("MKSE"),$=n("Cz+n");const{Module:M}=Shopware;M.register("buckaroo-payment",{type:"plugin",name:"BuckarooPayment",title:"buckaroo.general.title",description:"buckaroo.general.description",version:"1.0.0",targetVersion:"1.0.0",color:"#000000",icon:"default-action-settings",snippets:{"nl-NL":P,"de-DE":C,"en-GB":$},routeMiddleware(e,t){"sw.order.detail"===t.name&&t.children.push({component:"buckaroo-payment-detail",name:"buckaroo.payment.detail",isChildren:!0,path:"/sw/order/buckaroo/detail/:id"}),e(t)},routes:{index:{component:"buckaroo-settings",path:"index",meta:{parentPath:"sw.settings.index"}}}});n("2Glv"),n("czOy")},"q+HN":function(e,t){e.exports='{% block sw_settings_content_card_slot_plugins %}\n    {% parent %}\n\n    <sw-settings-item :label="$tc(\'buckaroo-payment.general.title\')"\n                      :to="{ name: \'buckaroo.payment.index\' }"\n                      :backgroundEnabled="false">\n        <template #icon>\n            <img class="sw-settings-index__buckaroo-icon" :src="\'buckaroopayment/plugin.png\' | asset">\n        </template>\n    </sw-settings-item>\n{% endblock %}\n'},qDl2:function(e,t,n){var o=n("6lJh");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);(0,n("SZ7m").default)("0736a430",o,!0,{})},wlgm:function(e,t){e.exports='{% block buckaroo_payment_detail %}\n    <div class="buckaroo-payment-detail">\n         <sw-card :title="$tc(\'Refund\')">\n            <sw-number-field :label="$tc(\'buckaroo-payment.refund.amountTitle\')" v-model="buckaroo_refund_amount"></sw-number-field>\n            <sw-button @click="refundOrder(orderId, buckaroo_refund_amount)" :disabled="!isRefundPossible">\n                {{ $tc(\'buckaroo-payment.refund.buttonTitle\') }}\n            </sw-button>\n         </sw-card>\n        <sw-loader v-if="isLoading">\n        </sw-loader>\n    </div>\n{% endblock %}'}},[["pLZ4","runtime","vendors-node"]]]);